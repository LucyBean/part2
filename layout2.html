<!DOCTYPE html>
<html>

<head>

<title>Untitled 1</title>
<!-- skulpt -->
<script src="./skulpt/support/closure-library/closure/goog/base.js" type="text/javascript"></script>
<script src="./skulpt/src/env.js" type="text/javascript"></script>
<script src="./skulpt/src/parser.js" type="text/javascript"></script>
<script src="./skulpt/src/tokenize.js" type="text/javascript"></script>
<script src="./skulpt/src/symtable.js" type="text/javascript"></script>
<script src="./skulpt/src/compile.js" type="text/javascript"></script>
<script src="./skulpt/gen/parse_tables.js" type="text/javascript"></script>
<script src="./skulpt/gen/astnodes.js" type="text/javascript"></script>
<script src="./skulpt/src/ast.js" type="text/javascript"></script>
<script src="./skulpt/src/misceval.js" type="text/javascript"></script>
<script src="./skulpt/src/type.js" type="text/javascript"></script>
<script src="./skulpt/src/builtin.js" type="text/javascript"></script>
<script src="./skulpt/src/abstract.js" type="text/javascript"></script>
<script src="./skulpt/src/object.js" type="text/javascript"></script>
<script src="./skulpt/src/function.js" type="text/javascript"></script>
<script src="./skulpt/src/seqtype.js" type="text/javascript"></script>
<script src="./skulpt/src/numtype.js" type="text/javascript"></script>
<script src="./skulpt/src/list.js" type="text/javascript"></script>
<script src="./skulpt/src/tuple.js" type="text/javascript"></script>
<script src="./skulpt/src/module.js" type="text/javascript"></script>
<script src="./skulpt/src/int.js" type="text/javascript"></script>
<script src="./skulpt/src/bool.js" type="text/javascript"></script>
<script src="./skulpt/src/str.js" type="text/javascript"></script>
<script src="./skulpt/src/dict.js" type="text/javascript"></script>
<script src="./skulpt/src/errors.js" type="text/javascript"></script>

<script src="./skulpt/src/enumerate.js" type="text/javascript"></script>
<script src="./skulpt/src/set.js" type="text/javascript"></script>
<script src="./skulpt/src/slice.js" type="text/javascript"></script>
<script src="./skulpt/src/method.js" type="text/javascript"></script>
<script src="./skulpt/src/structseq.js" type="text/javascript"></script>

<script src="./skulpt/src/sorted.js" type="text/javascript"></script>
<script src="./skulpt/src/timsort.js" type="text/javascript"></script>

<script src="./skulpt/src/file.js" type="text/javascript"></script>

<script src="./skulpt/src/native.js" type="text/javascript"></script>
<script src="./skulpt/src/ffi.js" type="text/javascript"></script>
<script src="./skulpt/src/generator.js" type="text/javascript"></script>
<script src="./skulpt/src/fromcodepoint.js" type="text/javascript"></script>

<script src="./skulpt/src/complex.js" type="text/javascript"></script>
<script src="./skulpt/src/biginteger.js" type="text/javascript"></script>
<script src="./skulpt/src/long.js" type="text/javascript"></script>
<script src="./skulpt/src/float.js" type="text/javascript"></script>
<script src="./skulpt/src/constants.js" type="text/javascript"></script>

<script src="./skulpt/src/formatting.js" type="text/javascript"></script>
<script src="./skulpt/src/print.js" type="text/javascript"></script>
<script src="./skulpt/src/builtindict.js" type="text/javascript"></script>
<script src="./skulpt/src/import.js" type="text/javascript"></script>

<script src="skulpt/skulpt-stdlib.js" type="text/javascript"></script>
<script src="skulpt/src/lib/turtle.js" type="text/javascript"></script>

<!-- My stuff -->
<script src="./formattedOutput.js" type="text/javascript"></script>
<script src="./myadditions.js" type="text/javascript"></script>
<script src="./drawing.js" type="text/javascript"></script>
<script src="./ilabelMeaning.js" type="text/javascript"></script>
<script src="./debug.js" type="text/javascript"></script>
<script src="./turtle/turtleTracker.js" type="text/javascript"></script>

<!-- CodeMirror -->
<script src="codemirror/codemirror.js" type="text/javascript"></script>
<script src="./codemirror/codemirror-5.9/addon/selection/active-line.js" type="text/javascript"></script>
<link rel="stylesheet" href="codemirror/codemirror.css">
<script src="codemirror/python.js" type="text/javascript"></script>

<!-- Fabric.js -->
<script src="./fabric/dist/fabric.js" type="text/javascript"></script>

<style type="text/css">
td.newStyle1 {
	margin: 5px;
	padding: 10px;
	background-color: #9999FF;
	vertical-align: top;
	text-align: left;
}
body {
	font-family: "Segoe UI";
}
h1 {
	font-size: 18px;
}
.rightMenuStyle {
	background-color:#CDDEFE;
	width:390px;
	height:670px;
	padding:5px;
}
.codeStyle {
	font-family:"Consolas";
	padding:1px;
	background-color:#CCFFCC;
}
</style>
</head>

<body>

<table style="width: 100%; height:100%">
	<tr>
		<td colspan="4">&nbsp;</td>
	</tr>
	<tr>
		<td rowspan="2">&nbsp;</td>
		<td class="newStyle1" style="width: 600px; height:600px;">
			<div id="codeWindow" style="width: 600px; height:600px;">
				<textarea id="yourCode">import turtle
babbage = turtle.Turtle()
babbage.shape("square")

n = 4
angle = 360/n

for i in range(n):
    babbage.right(angle)
    babbage.forward(90)
    babbage.stamp()
				</textarea>
			</div>
			<div id="turtleWindow" style="display:none; width:600px; height:295px;">
				<div id="turtleCanvas" style="width:600px; height:300px; background-color:white;"></div>
			</div>
		</td>
		<td class="newStyle1" style="width: 400px" rowspan="2">
			<div id="welcome" class="rightMenuStyle">
				<h1>Welcome to my project.</h1>
				<p>My project is looking at how syntax errors can be improved in order to help novice programmers.
				</p>
			</div>
			<div id="results" class="rightMenuStyle" style="display:none">
				<h1>Your code ran!</h1>
				<div id="resultDisplay" class="codeStyle">Results</div>
			</div>
			<div id="errorDisplay" class="rightMenuStyle" style="display:none;">
				<h1>Oh no! Looks like you had some errors...</h1>
				<div id="errorOutput" style="height:300px">Error report</div>
				<div style="width:390px; height:285px; margin:0px; padding:0px; overflow:auto">
					<canvas id="errCanvas"></canvas>
				</div>
			</div>
		</td>
		<td rowspan="2">&nbsp;</td>
	</tr>
	<tr>
		<td class="newStyle1" style="width: 600px; height:75px; padding:0px;">
		<table>
			<tr>
				<td>
					<img alt="Run code button" height="75" src="img/btn-run-unpressed.png" width="75" onclick="run()">					
					<img alt="Help" height="75" src="img/btn-help-unpressed.png" width="75" onclick="displayHelpPane()">
					<img alt="Display Turtle" height="75" src="img/btn-turtle-unpressed.png" width="75" onclick="toggleTurtle()">
				</td>
			</tr>
		</table>
		</td>
	</tr>
	<tr>
		<td colspan="4">&nbsp;</td>
	</tr>
</table>

<script type="text/javascript">
Sk.turtleTracker.reset();

var welcomeMessage = document.getElementById("welcome");
var resultsPage = document.getElementById("results");

var displayResultsPane = function () {
	welcomeMessage.style.display = "none";
	resultsPage.style.display = "block";
	errorDisplay.style.display = "none";
}

var displayHelpPane = function () {
	welcomeMessage.style.display = "block";
	resultsPage.style.display = "none";
	errorDisplay.style.display = "none";
}

var displayErrorPane = function () {
	welcomeMessage.style.display = "none";
	resultsPage.style.display = "none";
	errorDisplay.style.display = "block";
}

var myCodeMirror = CodeMirror.fromTextArea(document.getElementById("yourCode"), {
		lineNumbers: true,
		indentUnit: 4,
		styleActiveLine: true
	});
myCodeMirror.setSize(600, 600);

var displayTurtle = function () {
	turtleDisplayed = true;
	var codeWindow = document.getElementById("codeWindow");
	var turtleWindow = document.getElementById("turtleWindow");
	myCodeMirror.setSize(600, 290);
	codeWindow.style.height = "300px";
	turtleWindow.style.display = "block";
}

var hideTurtle = function () {
	turtleDisplayed = false;
	var codeWindow = document.getElementById("codeWindow");
	var turtleWindow = document.getElementById("turtleWindow");
	myCodeMirror.setSize(600, 600);
	codeWindow.style.height = "600px";
	turtleWindow.style.display = "none";
}

var turtleDisplayed = false;

var toggleTurtle = function () {
	if (!turtleDisplayed) {
		displayTurtle();

	} else {
		hideTurtle();

	}
}

var errCanvas = new fabric.Canvas("errCanvas");
errCanvas.setWidth(300);
errCanvas.setHeight(250);
errCanvas.backgroundColor = "white";
errCanvas.renderAll();


var output = document.getElementById("resultDisplay");
var errOut = document.getElementById("errorOutput");
Sk.formattedOutput.setOutputs({err:errOut, errCanvas:errCanvas});

var codeOutput = function (text) {
	output.innerHTML += text;
}
var builtinRead = function(x) {
    if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
            throw "File not found: '" + x + "'";
    return Sk.builtinFiles["files"][x];
}
var debugOut = function(arg) {
	var debug = true;
	if (debug) {
		console.log(arg);
	}
}

var run = function () {
	displayResultsPane();
	displayTurtle();
	myCodeMirror.save();
	var prog = document.getElementById("yourCode").value;
	
	output.innerHTML = "";
	errOut.innerHTML = "";
	errCanvas.clear();
	
	var turtleCanvas = document.getElementById("turtleCanvas");
	
	(Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = "turtleCanvas";
	Sk.configure({output:codeOutput, read:builtinRead, debugout:debugOut});

	try {
		var result = Sk.importMainWithBody("<stdin>", false, prog, true);
	   
		var myPromise = Sk.misceval.asyncToPromise(function() {
			return result;
		});
	   
		myPromise.then(function(mod) {console.log('success');},	function(err) {console.log(err.toString());});
		
	}
	catch (err) {
		displayErrorPane();
		if (err === "Incorrect syntax")	{
			console.log("Syntax was incorrect, but a fix was attempted.");
		}
		else {
			console.log(err);
			throw err;
		}
	}
}
</script>


</body>

</html>
